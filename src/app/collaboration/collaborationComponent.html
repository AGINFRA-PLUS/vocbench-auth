<div class="panel panel-default vbox">
    <div class="panel-heading" style="display: flex;">
        <label style="flex: 1">Collaboration System</label>

        <button class="btn btn-default btn-xs" (click)="initIssueList()" [disabled]="!issues">
            <span class="glyphicon glyphicon-refresh"></span>
        </button>
        <!-- This should be allowed only to project manager and admin -->
        <button class="btn btn-default btn-xs" style="margin-left: 3px" (click)="openConfig()">
            <span class="glyphicon glyphicon-cog"></span>
        </button>
    </div>
    
    <div class="panel-body vbox">

        <!-- Mandatory settings not configured (missing serverURL) -->
        <div *ngIf="!settingsConfigured; else elseBlock1" class="alert alert-warning" style="margin: 3px;">
            No Collaboration System has been configured. Please, configure a CS pushing the 
            <span class="glyphicon glyphicon-cog"></span> button in the top right corner.
        </div>
        <ng-template #elseBlock1>
            <!-- Mandatory settings configured, Mandatory preferences not configured (missing credentials) -->
            <div *ngIf="!preferencesConfigured; else elseBlock2" class="alert alert-warning" style="margin: 3px;">
                You need to be logged to the CS in order to see the issues list. Please, provide your credential pushing the
                <span class="glyphicon glyphicon-cog"></span> button in the top right corner.
            </div>

            <ng-template #elseBlock2>
                <!-- Mandatory settings and preferences configured, but no project is linked (optional settings) -->
                <div *ngIf="!csProjectLinked; else elseBlock3" class="alert alert-warning" style="margin: 3px;">
                    There is no CS project assigned to this Vocbench project.
                    <a style="cursor: pointer" (click)="assignProject()">Create or assign</a> a project.
                </div>

                <ng-template #elseBlock3>
                    <!-- All configured: mandatory settings and preferences, project linked -->
                    <div *ngIf="!csWorking" class="alert alert-warning" style="margin: 3px;">
                        Collaboration System seems to be configured but it is not working. 
                        Please, check if the configuration is valid, or be sure that the CS server is running.
                    </div>
                </ng-template>

            </ng-template>

        </ng-template>



        <table *ngIf="issues" class="table table-condensed table-hoverable">
            <colgroup>
                <col style="width: 1%">
                <col>
                <col>
                <col style="width: 1%">
            </colgroup>
            <tbody>
                <tr *ngFor="let i of issues">
                    <td nowrap>
                        <a [href]="i.getUrl()" target="_blank">{{i.getKey()}}</a>
                    </td>
                    <td>
                        {{i.getSummary()}}
                    </td>
                    <td>
                        <rdf-resource *ngFor="let r of i.getResources()" [resource]="r" class="clickable" (click)="onResourceClick(r)"></rdf-resource>
                    </td>
                    <td class="text-center">
                        <span [class]="'label ' + i.getStatusClass()" style="font-size: 100%">{{i.getStatus()}}</span>
                    </td>
                </tr>
            </tbody>
        </table>

    </div>
    
</div>